
#ifndef _PACKET_H__
#define _PACKET_H__

#define ADAPTER_INDEX 1

#define PACKET_SEND_BUFFER 1024
#define PACKET_RECV_BUFFER 1024

#define PACKET_RECV_BLOCK_TIME 3000

/*

	WARNING! Port Sniffer will no success because of icmp or network time out.
	Q1:Why i send sniffer packet to SUPPLICANT_SERVER_PORT but remote haven't return a ICMP unresearch packet to me ?
	A1:Because of network .UDP Sniffer is not like TCP ,but you can try to sniffer
	RED_SUPPLICANT_PORT1 , RED_SUPPLICANT_PORT2 and 4999
	TIPS:You can sniffer the SUPPLICANT_SERVER_PORT open when you send a crash packet to RED_SUPPLICANT client,
		 because a process 

*/

#define SUPPLICANT_SERVER_PORT 3848
#define RED_SUPPLICANT_PORT1 3852
#define RED_SUPPLICANT_PORT2 3855
#define LOCAL_PORT 10131

#define IPV4_LENGTH 0x11

#define SNIFFER_UDP_PORT_TIME 5000

extern char local_ip[IPV4_LENGTH];

bool packet_init(void);
void packet_clean(void);

bool packet_send(const char* targe_ip,const char* packet_buffer,unsigned int packet_length);
bool packet_send_recv(const char* targe_ip,unsigned int targe_port,const char* packet_buffer,unsigned int packet_length);
unsigned int packet_recv(char* packet_buffer);

bool sniffer_udp_port(const char* targe_ip,unsigned int targe_port);

bool check_ip_subnet(const char* targe_ip);

#endif
